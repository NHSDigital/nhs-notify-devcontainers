ARG BASE_CONTAINER_NAME
ARG CONTAINER_NAME
ARG BASE_IMAGE_TAG
ARG BASE_CONTAINER_PREFIX
ARG SCRIPTS_DIR=/usr/local/share/nhsnotify

FROM ${BASE_CONTAINER_PREFIX}${BASE_CONTAINER_NAME}:${BASE_IMAGE_TAG}
ARG BASE_CONTAINER_NAME
ARG CONTAINER_NAME
ARG BASE_IMAGE_TAG
ARG BASE_CONTAINER_PREFIX
ARG SCRIPTS_DIR

RUN test -n "${BASE_CONTAINER_NAME}" && \
    test -n "${CONTAINER_NAME}" && \
    test -n "${BASE_IMAGE_TAG}" && \
    test -n "${BASE_CONTAINER_PREFIX}"

ENV DEFAULT_IMAGE_TAG=${BASE_IMAGE_TAG}

COPY --chmod=755 scripts ${SCRIPTS_DIR}/${CONTAINER_NAME}
WORKDIR ${SCRIPTS_DIR}/${CONTAINER_NAME}
RUN ./install.sh
